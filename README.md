# StingrayTV Alice - Управление приёмником Триколора через Яндекс Алису

## Описание

Проект предоставляет интеграцию приёмника Триколора через сервис "Дом с Алисой".
Пользователи могут управлять своим приёмником голосом через Алису.

## Быстрый старт

### 1. Запуск с Docker Compose

```bash
# Клонируйте репозиторий
git clone <repository-url>
cd stingraytv-alice

# Запустите приложение
docker-compose up -d
```

### Процесс авторизации

1. Пользователь нажимает "Привязать к Яндексу" в приложении "Дом с Алисой"
2. Яндекс перенаправляет на страницу авторизации
3. Пользователь соглашается с авторизацией
4. Яндекс обменивает код на JWT токен
5. Токен используется для доступа к API навыка

## Безопасность

- Все API эндпоинты защищены JWT токенами
- Используется OAuth2 authorization code grant flow
- Сессии stateless для лучшей масштабируемости
- CSRF защита отключена для API (не требуется для stateless)
- Поддержка оповещений о разъединении аккаунтов (user unlink)

## API эндпоинты

### Умный дом Яндекс

- `GET /v1.0/user/devices` - получение списка устройств
- `POST /v1.0/user/devices/query` - запрос состояния устройств
- `POST /v1.0/user/devices/action` - выполнение действий с устройствами
- `POST /v1.0/user/unlink` - оповещение о разъединении аккаунтов

### OAuth2

- `GET /oauth/authorize` - авторизация пользователя
- `POST /oauth/token` - получение токенов

## Разработка

### Запуск в режиме разработки

```bash
./gradlew bootRun
```

### Запуск тестов

```bash
./gradlew test
```

### Сборка

```bash
./gradlew build
```

## Технологии

- **Java 21**
- **Spring Boot**
- **Spring Security**
- **Gradle**
- **Docker**

## Лицензия

GPLv3
